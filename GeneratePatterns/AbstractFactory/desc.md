# Шаблон "Абстрактная Фабрика" в проектировании интернет-магазина

## Что такое "Абстрактная фабрика"?

Шаблон "Абстрактная фабрика" предоставляет интерфейс для создания семейств взаимосвязанных объектов без указания их
конкретных классов. Этот паттерн позволяет абстрагировать процесс создания объектов, изолируя код, отвечающий за их
создание, от кода, использующего эти объекты. Это делает систему гибкой, легко расширяемой и поддерживаемой.

## Когда стоит использовать?

- Когда необходимо создавать различные продукты, которые могут изменяться независимо друг от друга.
- Когда нужно гарантировать совместимость создаваемых объектов.
- Когда система должна оставаться независимой от конкретных классов создаваемых объектов.

## Как это работает?

### Основные компоненты:

1. **Абстрактная фабрика** — интерфейс, определяющий методы для создания продуктов различных типов.
2. **Конкретная фабрика** — реализация абстрактной фабрики, которая создает конкретные продукты.
3. **Абстрактный продукт** — интерфейс или абстрактный класс для каждого продукта, который должен быть создан.
4. **Конкретный продукт** — реализация абстрактного продукта.

## Плюсы

- **Гибкость:** Упрощает изменение и расширение системы, так как новые продукты могут быть добавлены без изменения
  клиентского кода.
- **Совместимость:** Гарантирует, что созданные объекты будут совместимы друг с другом, что упрощает интеграцию.
- **Изоляция:** Разделяет код создания объектов от кода их использования, улучшая читаемость и поддержку.

## Минусы

- **Сложность:** Увеличивает количество классов и уровней абстракции, что может усложнить понимание системы.
- **Избыточность:** В некоторых случаях может быть избыточным, особенно если система не требует множества различных
  реализаций.
- **Увеличение времени разработки:** Необходимость создания дополнительных классов может увеличить время на разработку.

## Почему это полезно?

- Упрощает изменение и расширение системы.
- Позволяет избежать жесткой зависимости от конкретных реализаций.
- Снижает сложность и улучшает читаемость кода.

## Структура

![factory_pattern](uml.puml)
![factory_pattern](uml.png)

```
── AbstractFactory/
    ├── Client/
    │   └── Client.php                                # Клиент, который использует фабрики
    ├── Factories/
    │   ├── Contracts/
    │   │   ├── DressFactory.php                      # Интерфейс фабрики платьев
    │   │   └── SuitFactory.php                       # Интерфейс фабрики костюмов
    │   ├── ClothingDressFactory.php                  # Фабрика платьев для всех сезонов
    │   └── ClothingSuitFactory.php                   # Фабрика костюмов для всех сезонов
    ├── Products/
    │   ├── Mens/
    │   │   ├── Suits/
    │   │   │   ├── Contracts/
    │   │   │   │   └── MensSuitAbstract.php          # Абстрактный класс для мужских костюмов
    │   │   │   ├── AutumnMensSuit.php                # Осенний мужской костюм
    │   │   │   └── SpringMensSuit.php                # Весенний мужской костюм
    │   ├── Womens/
    │   │   ├── Dresses/
    │   │   │   ├── Contracts/
    │   │   │   │   └── WomensDressAbstract.php       # Абстрактный класс для женских платьев
    │   │   │   ├── AutumnWomensDress.php             # Осеннее женское платье
    │   │   │   ├── SpringWomensDress.php             # Весеннее женское платье
    │   │   │   └── SummerWomensDress.php             # Летнее женское платье
    │   │   └── Suits/
    │   │       ├── Contracts/
    │   │       │   └── WomensSuitAbstract.php        # Абстрактный класс для женских костюмов
    │   │       ├── AutumnWomensSuit.php              # Осенний женский костюм
    │   │       └── SpringWomensSuit.php              # Весенний женский костюм
    └── IndexController.php                           # Контроллер для обработки запросов (при необходимости)

```

# Применимость

- Система **не должна зависеть** от того, как создаются, компонуются и представляются объекты одежды (мужские костюмы
  или женские платья).
- Система должна поддерживать создание одежды через **фабрики** для различных сезонов (например, осенние, весенние
  коллекции).
- Входящие в семейство объекты одежды **спроектированы для совместной работы**, и необходимо обеспечить их сочетаемость.
- Необходимо предоставить библиотеку объектов, раскрывая только **интерфейсы фабрик и продуктов**, скрывая реализацию.

# Участники

- **DressFactory и SuitFactory (Фабрики Одежды)**:
    - Объявляют интерфейсы для операций, создающих абстрактные продукты одежды (платья или костюмы).

- **ClothingDressFactory и ClothingSuitFactory (Конкретные Фабрики)**:
    - Реализуют интерфейсы `DressFactory` и `SuitFactory`.
    - Создают конкретные объекты одежды для всех сезонов (например, весенние и осенние коллекции).

- **MensSuit и WomensDress (Абстрактные Продукты)**:
    - Определяют интерфейсы для различных типов продуктов одежды (мужские костюмы и женские платья).

- **AutumnMensSuit, SpringMensSuit, AutumnWomensDress, SummerWomensDress (Конкретные Продукты)**:
    - Конкретные реализации продуктов, создаваемые соответствующими фабриками.

- **Client (Клиент)**:
    - Использует фабрики и продукты через абстрактные интерфейсы.

# Отношения

- Во время выполнения создаётся **единственная конкретная фабрика**, которая отвечает за создание объектов-продуктов
  одежды.
- Фабрики `ClothingDressFactory` и `ClothingSuitFactory` создают объекты в зависимости от сезона.

# Результаты

- **Изолирует конкретные классы**: Клиент взаимодействует только с абстракциями, что упрощает замену или изменение
  внутренней реализации.
- **Упрощает замену семейств продуктов**: Семейство продуктов можно заменить другим, изменив конкретную фабрику, не
  изменяя клиентский код.
- **Гарантирует сочетаемость продуктов**: Продукты одного семейства спроектированы для совместной работы.
- **Не упрощает добавление новых типов продуктов**: Для добавления новых типов продуктов нужно изменить интерфейсы
  фабрик и их реализации.

# Реализация

- **ConcreteFactory** можно реализовать через паттерн **Одиночка (Singleton)** для гарантии единственности фабрики.
- Создание продуктов делегируется подклассам, часто реализуется через паттерн **Фабричный метод (Factory Method)**.
- Если много семейств продуктов, конкретные фабрики могут использовать паттерн **Прототип (Prototype)** для клонирования
  объектов.

# Расширяемость

- Добавление нового продукта требует изменения интерфейсов и всех реализаций, что усложняет расширение.
- Можно использовать метод `make(type)` с параметром для указания типа продукта, что снизит количество методов, но
  усложнит логику.

# Пример использования паттерна "Абстрактная фабрика" в интернет-магазине

### Применение

1. **Фильтрация по сезонам**: Фабрики создают различные объекты одежды (например, осенние или весенние коллекции) в
   зависимости от выбранного фильтра.
2. **Создание страниц товаров**: Абстрактная фабрика управляет созданием страниц товаров в зависимости от категории (
   например, одежда, аксессуары).
3. **Корзина товаров**: Разные типы товаров в корзине могут обрабатываться через соответствующие фабрики.
4. **Работа с платёжными системами**: Фабрики могут управлять созданием объектов для работы с различными платёжными
   шлюзами.
5. **Работа с логистикой и доставкой**: Создание объектов для разных типов доставки, таких как почтовая доставка или
   самовывоз.

### Когда не стоит использовать "Абстрактную фабрику"?

- **Простая структура объектов**: Если объекты имеют простую структуру, использование паттерна может быть избыточным.
- **Ограниченное количество продуктов**: В случае, если система не нуждается в большом количестве разных типов
  продуктов, достаточно более простых решений.

# Заключение

Паттерн "Абстрактная фабрика" полезен для создания связанных объектов, особенно если товары имеют различные атрибуты или
сезонные фильтры. В интернет-магазинах с широкой номенклатурой и большим количеством фильтров этот паттерн помогает
упростить работу с продуктами, сохраняя гибкость системы.
