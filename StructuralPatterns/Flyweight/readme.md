# Шаблон "Приспособленец" (Flyweight)

Шаблон "Приспособленец" уменьшает количество создаваемых объектов, экономя память, за счет использования совместных
объектов. Он разделяет состояние объекта на внутреннее (неизменяемое) и внешнее (изменяемое), позволяя многим объектам
разделять общее состояние.

## Что это такое?

Шаблон "Приспособленец" позволяет создавать объекты, которые могут быть разделены между различными частями программы.
Это особенно полезно, когда объекты имеют множество одинаковых характеристик, и их создание может быть ресурсоемким.

## Как это работает?

### Компоненты:

1. **Приспособленец:** Интерфейс или абстрактный класс, определяющий методы, которые будут использоваться клиентами.
2. **Конкретные приспособленцы:** Реализуют интерфейс приспособленца и хранят общее состояние.
3. **Фабрика приспособленцев:** Управляет созданием и хранением приспособленцев, обеспечивая их повторное использование.
4. **Клиент:** Использует объекты приспособленцев, передавая им внешние состояния.

## Плюсы

- **Экономия памяти:** Снижает потребление памяти за счет использования общих объектов.
- **Упрощение управления состоянием:** Позволяет управлять состоянием объектов более эффективно.
- **Улучшение производительности:** Уменьшает нагрузку на систему, особенно при создании большого количества объектов.

## Минусы

- **Усложнение кода:** Введение дополнительных уровней абстракции может усложнить структуру кода.
- **Сложность управления состоянием:** Необходимость отделять внутреннее и внешнее состояние может привести к ошибкам и
  путанице.
- **Потенциальные проблемы с производительностью:** Если не правильно организовать хранение приспособленцев, это может
  снизить производительность.

## Когда использовать?

Паттерн «Приспособленец» (Flyweight) помогает экономить память в ситуациях, когда в системе создаётся много объектов с
одинаковыми или похожими данными. Вместо того чтобы хранить множество однотипных объектов, мы делаем так, что они
разделяют общие данные, а уникальные части выносятся отдельно.

### Когда использовать:

- **Много одинаковых объектов.** Если в приложении создаётся множество однотипных объектов, это может занять много
  памяти.
- **Большие затраты на хранение.** Слишком много объектов может перегружать систему.
- **Можно выделить общее состояние.** Если объекты имеют общие части, которые можно сделать разделяемыми.
- **Объекты не должны сильно отличаться друг от друга.** То есть, если не важно, что объекты делят часть состояния, и не
  требуется, чтобы каждый объект был полностью уникальным.

Представьте, что у вас есть интернет-магазин, где каждый товар хранится в корзине покупателя. Вместо того чтобы для
каждого покупателя хранить всю информацию о каждом товаре (название, цена, категория), можно использовать паттерн
«Приспособленец»:

Общее состояние: Название товара, цена и описание могут быть общими для всех покупателей, потому что они всегда
одинаковы для данного товара.
Внешнее состояние: Уникальная для каждого покупателя информация, например, количество товаров в корзине и выбранные
опции (цвет, размер), будет храниться отдельно.

## Давайте рассмотрим пример использования паттерна «Приспособленец» в интернет-магазине одежды.

### Участники:

- **Flyweight (Товар):** Интерфейс для объектов одежды, который позволяет использовать общее состояние (например,
  описание,
  цену) и взаимодействовать с внешним состоянием (размер, количество).

- **ConcreteFlyweight (Конкретный товар — Футболка):** Реализует интерфейс товара и хранит внутреннее состояние — общую
  информацию о товаре, которая не зависит от клиента (например, название товара, его описание, цена). Эти данные могут
  быть использованы разными клиентами.

- **UnsharedConcreteFlyweight (Корзина покупок):** Представляет объекты, которые не могут быть разделены между
  пользователями,
  например, корзину с товарами, где каждому клиенту требуется хранить уникальные данные (сколько штук товара, какой
  размер
  или цвет выбран).

- **FlyweightFactory (Фабрика товаров):** Отвечает за создание и управление объектами товаров. Фабрика проверяет,
  существует
  ли уже товар с таким описанием и ценой, и если существует, возвращает уже созданный объект. Если товар еще не создан,
  фабрика создаст новый объект.

- **Client (Пользователь):** Клиент магазина, который добавляет товары в корзину и передает внешнее состояние товара (
  размер,
  цвет и количество) при взаимодействии с товаром.
